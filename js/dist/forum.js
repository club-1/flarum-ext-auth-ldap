(()=>{var t={n:o=>{var e=o&&o.__esModule?()=>o.default:()=>o;return t.d(e,{a:e}),e},d:(o,e)=>{for(var n in e)t.o(e,n)&&!t.o(o,n)&&Object.defineProperty(o,n,{enumerable:!0,get:e[n]})},o:(t,o)=>Object.prototype.hasOwnProperty.call(t,o),r:t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}},o={};(()=>{"use strict";t.r(o);const e=flarum.core.compat["common/extend"],n=flarum.core.compat["common/app"];var r=t.n(n);const a=flarum.core.compat["components/HeaderSecondary"];var i=t.n(a);const s=flarum.core.compat["components/SettingsPage"];var c=t.n(s);const p=flarum.core.compat["components/Button"];var l=t.n(p);const u=flarum.core.compat["components/LogInModal"];var d=t.n(u);function f(t,o){return f=Object.setPrototypeOf||function(t,o){return t.__proto__=o,t},f(t,o)}flarum.core.compat.extend;const h=flarum.core.compat.app;var y=t.n(h);const b=flarum.core.compat["components/Modal"];var g=t.n(b);flarum.core.compat["components/SignUpModal"],flarum.core.compat["components/LogInButtons"];const v=flarum.core.compat["utils/extractText"];var _=t.n(v);const w=flarum.core.compat["utils/ItemList"];var j=t.n(w);const x=flarum.core.compat["utils/Stream"];var N=t.n(x),P=function(t){var o,e;function n(){return t.apply(this,arguments)||this}e=t,(o=n).prototype=Object.create(e.prototype),o.prototype.constructor=o,f(o,e);var r=n.prototype;return r.oninit=function(o){t.prototype.oninit.call(this,o),this.identification=N()(this.attrs.identification||""),this.password=N()(this.attrs.password||""),this.remember=N()(!!this.attrs.remember)},r.className=function(){return"LogInModal Modal--small"},r.title=function(){return y().translator.trans("tituspijean-auth-ldap.forum.log_in_with",{server:y().forum.attribute("LDAP_method_name")})},r.content=function(){return[m("div",{className:"Modal-body"},this.body()),m("div",{className:"Modal-footer"},this.footer())]},r.body=function(){return[m("div",{className:"Form Form--centered"},this.fields().toArray())]},r.fields=function(){var t=new(j());return t.add("identification",m("div",{className:"Form-group"},m("input",{className:"FormControl",name:"identification",type:"text",placeholder:_()(y().translator.trans("core.forum.log_in.username_or_email_placeholder")),bidi:this.identification,disabled:this.attrs.loading})),30),t.add("password",m("div",{className:"Form-group"},m("input",{className:"FormControl",name:"password",type:"password",placeholder:_()(y().translator.trans("core.forum.log_in.password_placeholder")),bidi:this.password,disabled:this.attrs.loading})),20),t.add("submit",m("div",{className:"Form-group"},l().component({className:"Button Button--primary Button--block",type:"submit",loading:this.attrs.loading},y().translator.trans("core.forum.log_in.submit_button"))),-10),t},r.footer=function(){return[]},r.onready=function(){this.$("[name="+(this.identification()?"password":"identification")+"]").select()},r.onsubmit=function(t){t.preventDefault(),this.loading=!0;var o={identification:this.identification(),password:this.password(),remember:this.remember(),csrfToken:y().session.csrfToken},e=(this.onerror.bind(this),$(window)),n=y().forum.attribute("baseUrl")+"/auth/ldap",r="ldapauth",a=document.createElement("form");for(var i in a.setAttribute("method","POST"),a.setAttribute("action",n),a.setAttribute("target",r),o)if(o.hasOwnProperty(i)){var s=document.createElement("input");s.type="hidden",s.name=i,s.value=o[i],a.appendChild(s)}document.body.appendChild(a),window.open("",r,"width=600,height=400,top="+(e.height()/2-200)+",left="+(e.width()/2-300)+",status=no,scrollbars=no,resizable=no"),a.submit(),document.body.removeChild(a)},r.onerror=function(o){401===o.status&&(o.alert.children=y().translator.trans("core.forum.log_in.invalid_login_message")),t.prototype.onerror.call(this,o)},n}(g());r().initializers.add("tituspijean-auth-ldap",(function(){(0,e.extend)(i().prototype,"items",(function(t){t.has("logIn")&&t.add("logInLDAP",l().component({className:"Button Button--link",onclick:function(){return r().modal.show(P)}},r().translator.trans("tituspijean-auth-ldap.forum.log_in_with",{server:r().forum.attribute("tituspijean-auth-ldap.method_name")})),0)})),(0,e.extend)(i().prototype,"items",(function(t){r().forum.attribute("tituspijean-auth-ldap.onlyUse")&&(t.has("signUp")&&t.remove("signUp"),t.has("logIn")&&t.remove("logIn"))})),(0,e.extend)(d().prototype,"content",(function(){r().forum.attribute("tituspijean-auth-ldap.onlyUse")&&(d().prototype.content=P.prototype.content,d().prototype.title=P.prototype.title,d().prototype.body=P.prototype.body,d().prototype.fields=P.prototype.fields,d().prototype.footer=P.prototype.footer,d().prototype.onsubmit=P.prototype.onsubmit)})),(0,e.extend)(c().prototype,"accountItems",(function(t){t.remove("changeEmail"),t.remove("changePassword")})),(0,e.extend)(c().prototype,"settingsItems",(function(t){t.has("account")&&0===t.get("account").children.length&&t.remove("account")}))}))})(),module.exports=o})();
//# sourceMappingURL=forum.js.map